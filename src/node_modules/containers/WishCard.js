import React from 'react'
import { useNavigate, useLocation } from 'react-router-dom'
import { useSelector } from 'react-redux'

import { WishButton } from 'components/Button'
import { ImagePlaceholder } from 'components/Icon'

export const WishCard = ({ wish }) => {
    const w = wish;
    if(!w) return null;

    const currency = w.currency==='rouble' ? ' ₽'
                   : w.currency==='yuan'   ? ' Ұ'
                   : w.currency==='usd'    ? ' $'
                   : w.currency==='euro'   ? ' €'
                   : '';

    const priceBlock = w.price ? (
        <span className='price'>
            {w.price + currency}
        </span>
    ) : null

    const loca = useLocation().pathname
    const slashCorrection = loca.at(-1) === '/'
        ? '' : '/'
    const path = loca + slashCorrection + w.id;
    const navigate = useNavigate();
    const handleClick = () => { navigate(path) };

    const currentColumnWidth = useSelector(state => state.mCTLayout.columnWidth)
    const heightCorrection = { height: `${Math.round(currentColumnWidth / w.imageAspectRatio)}px` }

    return (
        <div
            className={'wishcard fade-in'}
            key={ w.id }
            onClick={ handleClick }
        >
            <div className='img-wrapper' style={ heightCorrection }>
                { w.image
                    ? <img src={ w.image }></img>
                    : <ImagePlaceholder/>
                }
            </div>
            <div className='wishcard-content'>
                <span className='title'>{ w.title }</span>
                { priceBlock }
            </div>
            <WishButton wish={ w }/>
            <div className='stars'></div>
        </div>
    )
}