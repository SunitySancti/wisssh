import React from 'react'

import { User } from 'components/User'
import { WishlistLinePointer } from 'components/Icon'

export const WishlistLine = ({ wishlist }) => {
    const wl = wishlist;

    const TimeInfo = () => {
        if(!wl.date) return null;

        const [eventDay, eventMonth, eventYear] = wl.date.split('.');
        const eventTS = new Date( eventYear, eventMonth - 1, eventDay).getTime();
        const nowTS = Date.now();
        const daysToEvent = Math.ceil((eventTS - nowTS)/86400000)

        let content
        if(daysToEvent > 2) {
            const ending = (daysToEvent > 10) && (daysToEvent < 15)
            const lastNum = parseInt(daysToEvent.toString().at(-1))
            ? 'дней' : lastNum === 1
            ? 'день' : lastNum === 2 || lastNum === 3 || lastNum === 4
            ? 'дня'  : 'дней';

            return content = (
                <div className='future'>
                    <span className='small'>через</span>
                    <span className='big'>{ daysToEvent }</span>
                    <span className='small'>{ ending }</span>
                </div>
            );
        } else if(daysToEvent === 2) {
            return content = (
                <div className='future'>
                    <span className='small'>Послезавтра!</span>
                </div>
            );
        } else if(daysToEvent === 0) {
            return content = (
                <div className='future'>
                    <span className='small'>Сегодня!</span>
                </div>
            );
        } else if(daysToEvent < 0) {
            return content = (
                <div className='past'>
                    <span className='small'>{ wl.date }</span>
                </div>
    )}}

    return (
        <div className='wishlist-line'>
            <User
                isPicOnly={ true }
                picSize='66'
                userName={ wl.author }
            />
            <div className='title-container'>
                <WishlistLinePointer/>
                <div className='title'>{ wl.title }</div>
            </div>
            <div className='description'>
                 { wl.description }
            </div>
            <TimeInfo/>
        </div>
    );
}