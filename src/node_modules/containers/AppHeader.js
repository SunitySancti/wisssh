import React, { useEffect } from 'react'
import { Link, useLocation } from 'react-router-dom'
import { Outlet } from 'react-router'
import { useDispatch } from 'react-redux'

import { LogoIcon, LogoBack } from 'components/Icon'
import { Highlighter, Goo } from 'components/Highlighter'
import { switchSectionSlider } from 'store/sliderSlice'

export const AppHeader = () => {
    const loca = useLocation().pathname.split('/').at(1)
    const isMyWishes = loca === 'my-wishes'

    const dispatch = useDispatch();
    const setTransitions = () => {
        document.querySelectorAll('.goo-highlighters .highlighter').forEach((elem) => {
            elem.classList.add('animated');
        });
    }
    const clearTransitions = () => {
        document.querySelectorAll('.goo-highlighters .highlighter').forEach ((elem) => {
        elem.classList.remove('animated');
    })}

    useEffect(() => {
        setTransitions();
        dispatch(switchSectionSlider());
        setTimeout(clearTransitions, 600);
    }, [ loca ])
        
    return (
        <div className='app-layout'>
            <div className='app-header'>
                <div className='goo-highlighters'>
                    <Highlighter location='left-section-slider'/>
                    <Highlighter location='right-section-slider'/>
                    <LogoBack/>
                    <Goo/>
                </div>
                <div className='center-group'>
                    <Link
                        to='/my-wishes/items/actual'
                        className={ isMyWishes ? 'section my-wishes active' : 'section my-wishes' }
                    >
                        Мои желания
                    </Link>
                    <Link to="/my-wishes/items/actual" className='logo-btn'>
                        <LogoIcon/>
                    </Link>
                    <Link
                        to='/my-invites/items/reserved'
                        className={ isMyWishes ? 'section my-invites' : 'section my-invites active' }
                    >
                        Приглашения
                    </Link>
                </div>
            </div>
            
            <Outlet/>
            
        </div>
    );
}