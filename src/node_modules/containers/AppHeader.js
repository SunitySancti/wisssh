import React, { useLayoutEffect, useState } from 'react'
import { NavLink, Link, useParams, useMatch } from 'react-router-dom'
import { Outlet } from 'react-router'
import { useSelector } from 'react-redux'

import { LogoIcon } from 'components/Icon'

export const AppHeader = () => {
    const wishLists = useSelector(state => state.wishLists.all)
    const { id: currentWishListId } = useParams();
    const currentWishList = wishLists[currentWishListId];

    const activeTab = document.querySelector('header-nav active')
    const [highlightCoords, setHighlightCoords] = useState(null)
    useLayoutEffect(() => {
        setHighlightCoords({
            x: 0,
            y: 0,
            width: 0,
            height: 0
        });
        console.log(highlightCoords)
    }, [])
    
    const Highlight = () => <div className='highlight'></div>
    const Slash = () => <div className='header-nav'>/</div>
    const Tab = ({ children, to, ...props }) => {
        const match = useMatch({ path: to, end: false });
        match && console.log('path is match with: ',match);

        return (
            <Link
                to={ to }
                {...props}
                className={ match
                    ? 'header-nav active'
                    : 'header-nav'
                }
            >
                { children }
            </Link>
        );
    }
    return (
        <div className='app-layout'>
            <div className='app-header'>
                <div className='logo'>
                    <NavLink to="/my-wishes/actual" className='logo-btn'>
                        <LogoIcon/>
                    </NavLink>
                </div>
                <div className='tab-group my-wishes'>
                    <Tab to="/my-wishes/" >Мои желания</Tab>
                    { currentWishList && <div><Slash/><Tab to={"/wishlists/my/" + currentWishList.id} >{currentWishList.title}</Tab></div> }
                </div>
                <div className='tab-group my-invites'>
                    <Tab to="/my-invites/" >Мои пришлашения</Tab>
                    { false && <div><Slash/><Tab to="/wishlists/{ here must be userId }/" >День рождения</Tab></div> }
                </div>
            </div>
            
            <Outlet/>
            
        </div>
    );
}