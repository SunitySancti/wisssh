import React, { useEffect } from 'react'
import { Link, useMatch } from 'react-router-dom'
import { Outlet } from 'react-router'
import { useDispatch } from 'react-redux'

import { LogoIcon, LogoBack } from 'components/Icon'
import { Highlighter } from 'components/Highlighter'
import { setHighlighterCoordsInAppHeader } from 'store/highlighterSlice'

export const AppHeader = () => {    
    const Tab = ({ children, to }) => {
        const match = useMatch({ path: to.substring(0, 11), end: false });

        const dispatch = useDispatch();
        useEffect(() => {
            dispatch(setHighlighterCoordsInAppHeader())
        })

        return (
            <Link to={ to } className={ match ? 'header-nav active' : 'header-nav' } >
                { children }
            </Link>
        );
    }

    return (
        <div className='app-layout'>
            <div className='app-header'>
                <Highlighter location='app-header'/>
                <div className='center-group'>
                    <Tab to="/my-wishes/items/actual" >Мои желания</Tab>
                    <Link to="/my-wishes/items/" className='logo-btn'>
                        <LogoBack/>
                        <LogoIcon/>
                    </Link>
                    <Tab to="/my-invites/items/reserved" >Приглашения</Tab>
                </div>
            </div>
            
            <Outlet/>
            
        </div>
    );
}