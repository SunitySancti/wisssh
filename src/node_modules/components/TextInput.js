import React from 'react'

import { generateId } from 'getters/idGen'
import { Icon } from 'components/Icon'
import { TextLabel } from 'components/TextLabel'

export const TextInput = ({
    register,
    name,
    label,
    labelWidth,
    type,
    multiline,
    required,
    maxLength,
    formState,
    ...rest}) => {
    const id = generateId();
    const errorTypes = ({
       required: formState?.errors[name]?.type === 'required',
       maxLength: formState?.errors[name]?.type === 'maxLength',
    });
    const anyError = errorTypes.required || errorTypes.maxLength

    return (
        <div className='text-input'>
            { label && (
                <TextLabel
                    htmlFor={id}
                    text={label}
                    style={{ width: labelWidth }}
                    required={required}
                />
            )}
            { multiline
            ?   <>
                    <textarea
                        id={id}
                        {...register(name)}
                        className={anyError ? 'error' : null}
                        {...rest}
                    />
                    <Icon name='resizer' size='22'/>
                </>
            :   <input
                    id={id}
                    type={type || 'text'}
                    {...register(name, {
                        required,
                        maxLength
                    })}
                    className={anyError ? 'error' : null}
                    {...rest}
                />
            }
            { errorTypes.required &&
                <span className='error-message'>"{label}" — обязательное поле</span>
            }
        </div>
    );
}