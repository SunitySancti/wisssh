import React, { useLayoutEffect } from 'react'

import { MultiColumnTapeLayout } from 'containers/MultiColumnTapeLayout'
import { useLocation } from 'react-router'
import { useSelector, useDispatch } from 'react-redux'

import { putItems } from 'store/mCTLayoutSlice'

export const WishesPage = () => {
    const loca = useLocation().pathname;
    const dispatch = useDispatch();
    const firstLvl = loca.split('/').at(1);
    const thirdLvl = loca.split('/').at(3);

    const allWishes = (firstLvl === 'my-wishes')
                    ? useSelector(state => state.wishes.ofCurrentUser)
                    : useSelector(state => state.wishes.ofOtherUsers);

    const wishes = (thirdLvl === 'all')
                 ? allWishes
                 : thirdLvl === 'actual'
                 ? allWishes.filter(wish => wish.state === 'reserved' || wish.state === 'actual')
                 : allWishes.filter(wish => wish.state === thirdLvl)

    useLayoutEffect(() => {
        dispatch(putItems( wishes ));
    })

    return <MultiColumnTapeLayout/>
}