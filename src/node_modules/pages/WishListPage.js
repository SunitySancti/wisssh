import { React, useEffect } from 'react'
import { useLocation } from 'react-router-dom'
import { useSelector, useDispatch } from 'react-redux'

import { WishlistLine } from 'containers/WishlistLine'
import { MCTLayout } from 'containers/MCTLayout'
import { putItems } from 'store/mCTLayoutSlice'
import { getWishlistById } from 'getters'
import { WishCard } from 'containers/WishCard'

export const WishlistPage = () => {
    const dispatch = useDispatch();
    const loca = useLocation().pathname
    const wishlistId = loca.split('/').at(-1)
        ? loca.split('/').at(-1)
        : loca.split('/').at(-2);
    const wl = getWishlistById(wishlistId);

    const wishes = useSelector(state => state.wishes.all);
    const filteredWishes = wishes.filter(wish => wish.wishlistIds.includes(wl.id));

    useEffect(() => {
        dispatch(putItems(filteredWishes));
    },[])

    return (
        <div>
            <WishlistLine
                wishlist={ wl }
                onWishlistPage={ true }
            />
            <MCTLayout Component={WishCard}/>
        </div>
    );
}